---
const LINKS = [
  { name: "Inicio", id: "home" },
  { name: "Sobre mi", id: "about" },
  { name: "Proyectos", id: "proyectos" },
  { name: "Contacto", id: "contacto" },
];

---
<nav class="fixed left-0 top-0 z-50 w-full px-8 py-6 backdrop-blur-2xl">
    <div class="mx-auto flex max-w-7xl items-center justify-between">
  
      <!-- IZQUIERDA -->
      <a href="/" class="flex items-center gap-3">
        <img src="/logo.svg" alt="Logo" class="h-11 w-11 rounded-full object-cover" />
        <h1 class="text-xl font-semibold text-white">Desarrollador Web</h1>
      </a>
  
      <!-- LINKS -->
      <ul class="flex gap-12">
        {LINKS.map((link) => (
          <li>
            <button
              data-id={link.id}
              onclick={`scrollToSection('${link.id}')`}
              class="nav-btn group relative cursor-pointer px-6 py-1 text-white transition-colors duration-300 hover:text-green-400"
            >
              {link.name}
  
              <!-- esquina sup izq -->
              <span class="corner-tl pointer-events-none absolute -left-1.5 -top-1.5 size-7 border-l-[3px] border-t-[3px] border-green-400 opacity-0 transition-all duration-600 group-hover:opacity-100" />
  
              <!-- esquina inf der -->
              <span class="corner-br pointer-events-none absolute -bottom-1.5 -right-1.5 size-7 border-b-[3px] border-r-[3px] border-green-400 opacity-0 transition-all duration-600 group-hover:opacity-100" />
            </button>
          </li>
        ))}
      </ul>
    </div>
  </nav>
  


<style>
    .nav-btn.active {
    color: #4ade80;
  }

  .nav-btn.active .corner-tl,
  .nav-btn.active .corner-br {
    opacity: 1;
  }
</style>


<script is:inline>
    function scrollToSection(id) {
      const navHeight = 96; // altura aproximada del navbar
      const el = document.getElementById(id);
      if (!el) return;
  
      const y = el.getBoundingClientRect().top + window.scrollY - navHeight;
  
      window.scrollTo({
        top: y,
        behavior: "smooth",
      });
    }
  
  </script>
  
  <script is:inline type="module" >
    
    // SCROLL SPY
    const buttons = document.querySelectorAll(".nav-btn");
    const sections = [...buttons].map((btn) => {
          const section = document.getElementById(btn.dataset.id)
          return section;

    }
    );
  
    console.log(sections);
    const observer = new IntersectionObserver(
      (entries) => {
        entries.forEach((entry) => {
          const btn = document.querySelector(
            `.nav-btn[data-id="${entry.target.id}"]`
          );
  
          if (!btn) return;
  
          if (entry.isIntersecting) {
            buttons.forEach((b) => b.classList.remove("active"));
            btn.classList.add("active");
          }
        });
      },
      {
        rootMargin: "-40% 0px -50% 0px",
        threshold: 0,
      }
    );
  
    sections.forEach((section) => {
      if (section) observer.observe(section);
    });
  </script>